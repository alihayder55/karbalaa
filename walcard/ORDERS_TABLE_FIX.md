# إصلاح جدول الطلبات - إضافة الأعمدة المفقودة

## المشكلة
كانت صفحة تفاصيل الطلب تحاول الوصول إلى أعمدة غير موجودة في جدول `orders`:
- `customer_name`
- `customer_phone` 
- `delivery_address`
- `delivery_notes`
- `order_notes`

## الحل
تم إنشاء سكريبت SQL لإضافة الأعمدة المفقودة إلى جدول `orders`.

## الأعمدة المضافة:

### 1. customer_name
- **النوع**: TEXT
- **الوصف**: اسم العميل
- **قابلية الإفراغ**: نعم

### 2. customer_phone
- **النوع**: TEXT
- **الوصف**: رقم هاتف العميل
- **قابلية الإفراغ**: نعم

### 3. delivery_address
- **النوع**: TEXT
- **الوصف**: عنوان التوصيل
- **قابلية الإفراغ**: نعم

### 4. delivery_notes
- **النوع**: TEXT
- **الوصف**: ملاحظات التوصيل من العميل
- **قابلية الإفراغ**: نعم

### 5. order_notes
- **النوع**: TEXT
- **الوصف**: ملاحظات إضافية للطلب
- **قابلية الإفراغ**: نعم

## كيفية التطبيق:

### الخطوة 1: تشغيل سكريبت SQL
1. افتح Supabase Dashboard
2. اذهب إلى SQL Editor
3. انسخ محتوى ملف `fix-orders-table.sql`
4. اضغط Run

### الخطوة 2: التحقق من النتيجة
بعد تشغيل السكريبت، ستظهر رسالة نجاح:
```
Orders table updated successfully! All required columns are now available.
```

### الخطوة 3: اختبار التطبيق
1. افتح التطبيق
2. اذهب إلى صفحة الطلبات
3. اضغط على أي طلب لعرض التفاصيل
4. تأكد من عرض جميع المعلومات

## هيكل جدول orders بعد التحديث:

```sql
CREATE TABLE orders (
    id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
    user_id UUID,
    merchant_id UUID,
    status TEXT DEFAULT 'pending',
    total_price NUMERIC(12, 2) NOT NULL,
    customer_name TEXT,           -- ✅ جديد
    customer_phone TEXT,          -- ✅ جديد
    delivery_address TEXT,        -- ✅ جديد
    delivery_notes TEXT,          -- ✅ جديد
    order_notes TEXT,             -- ✅ جديد
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPZ DEFAULT NOW()
);
```

## بيانات تجريبية:

تم إضافة طلب تجريبي للاختبار:
- **اسم العميل**: أحمد محمد
- **رقم الهاتف**: +9647501234567
- **العنوان**: شارع الرشيد، بغداد، العراق
- **ملاحظات التوصيل**: يرجى التوصيل في الصباح قبل الساعة 10
- **ملاحظات الطلب**: طلب عاجل - يرجى التحضير بسرعة
- **السعر الإجمالي**: 250,000 دينار عراقي

## الميزات الجديدة:

### 1. معلومات العميل الكاملة
- اسم العميل
- رقم الهاتف
- عنوان التوصيل

### 2. ملاحظات التوصيل
- ملاحظات العميل للتوصيل
- تعليمات خاصة للتوصيل

### 3. ملاحظات الطلب
- ملاحظات إضافية للطلب
- معلومات خاصة بالطلب

### 4. عرض ديناميكي
- جميع البيانات من قاعدة البيانات
- عرض "غير محدد" إذا كانت البيانات غير متوفرة

## النتيجة:
✅ **جميع الأعمدة المطلوبة متوفرة**  
✅ **صفحة تفاصيل الطلب تعمل بشكل صحيح**  
✅ **عرض جميع معلومات الطلب**  
✅ **بيانات تجريبية للاختبار** 